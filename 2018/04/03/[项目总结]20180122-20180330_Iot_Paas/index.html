<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="总结,项目总结," />








  <link rel="shortcut icon" type="image/x-icon" href="https://o3sw4xojp.qnssl.com/paper_airplane.png?v=5.1.0" />






<meta name="description" content="2018.01.22 - 2018. 03.30, 我在某车厂Iot Paas项目上做前端dev。这是我第一个经历了完整研发周期的项目，在各个阶段遇见不同的种类的困难，带来很多不一样的体验。">
<meta property="og:type" content="article">
<meta property="og:title" content="Iot Paas项目总结">
<meta property="og:url" content="http://yoursite.com/2018/04/03/[项目总结]20180122-20180330_Iot_Paas/index.html">
<meta property="og:site_name" content="萝三画室">
<meta property="og:description" content="2018.01.22 - 2018. 03.30, 我在某车厂Iot Paas项目上做前端dev。这是我第一个经历了完整研发周期的项目，在各个阶段遇见不同的种类的困难，带来很多不一样的体验。">
<meta property="og:updated_time" content="2018-05-14T07:27:02.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Iot Paas项目总结">
<meta name="twitter:description" content="2018.01.22 - 2018. 03.30, 我在某车厂Iot Paas项目上做前端dev。这是我第一个经历了完整研发周期的项目，在各个阶段遇见不同的种类的困难，带来很多不一样的体验。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2018/04/03/[项目总结]20180122-20180330_Iot_Paas/"/>





  <title> Iot Paas项目总结 | 萝三画室 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">萝三画室</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
    
      <p class="site-subtitle">向死而生</p>
    
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/04/03/[项目总结]20180122-20180330_Iot_Paas/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="LOLISuri">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="https://o3sw4xojp.qnssl.com/avatar.jpg">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="萝三画室">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="萝三画室" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Iot Paas项目总结
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-04-03T10:01:26+08:00">
                2018-04-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>2018.01.22 - 2018. 03.30, 我在某车厂Iot Paas项目上做前端dev。这是我第一个经历了完整研发周期的项目，在各个阶段遇见不同的种类的困难，带来很多不一样的体验。</p>
<a id="more"></a>
<p>对于前端，这个项目并没有很复杂的业务逻辑，核心的功能就是数据的增删改查。并且前端技术栈采用的是我比较熟悉的vue，所以在单纯的业务卡上并没有遇到很多挑战，几乎可以说是平稳进行的。所以我把更多精力放在代码质量以及对vue的深度使用上。</p>
<p>我做了什么：</p>
<ol>
<li>20个通用组件。<br>写通用组件是我比较喜欢的任务，因为通用组件就意味着不带任何业务逻辑，不对外部做任何预设，保证组件对外的简单易用，易扩展等等…写通用组件让我觉得自己是个设计师（笑。其实在前端组件化的context之下，写通用组件就是写类。</li>
<li>N多业务组件<br>对于这个项目，在通用组件写好的情况下，业务组件是相对简单的， 它只是按照需求将通用组件组合起来使用。但在业务组件中，也存在可以抽成一个通用业务组件的情况。比如我们的新建和修改使用的是同一个popup，区别只在于一个初始化时有数据，一个初始化时无数据，以及发送的请求methods不一样而已。这时我们就可以将这个popup写得更通用一些，使得N个功能都可以使用这同一个组件。</li>
<li>修改整体layout和路由<br>项目刚开始的时候给自己挖了个大坑，全局观不好，以至于后续需要大概layout。同时对vue-router和vuex某些特性的错误判断，导致在解决这个问题的时候，跑错了很多路。这部分会在vue的总结中详述。</li>
<li>抽方法<br>通过各种方式减少代码重复：抽utils按需引入,filter,mixin,全局注册,vuex…这里我觉得思路比较好的是将loading和error抽出。其实这个思路是从上个项目中踩的坑来的。上个项目中，在上线前不久才发现，整个前端没有在向后端请求过程中加loading以阻止用户的其他操作。因此在这个项目已开始，我们就对每个请求加上了loading。后来发现请求的错误处理也大多保持一致的行为，所以也把errorHandler抽成vuex。但此时发现，即便将其抽到vuex，也还是需要在每次请求的时候都调用一次，我就开始向能否在某个地方统一处理一次即可。最后，我们将loading和error的调用写在了axios提供的返回拦截器中。最后就变成了：逻辑写在vuex中，调用写在返回拦截器中。</li>
<li>选择和使用第三方库<br>项目中有三处需要借助第三方库来实现功能：展示并高亮显示json, 编辑json并实时高亮，markdown loader。<br>第一个只是静态展示json，在stack overflow上看到别人写的一个函数就可以完美实现，于是我按照vue的思路造了一个通用组件出来。第二个就复杂了，她其实是个在线json编辑器，还需要实时高亮，缩进正确。开始的时候在git上找到用vue写的两个库，但都需要在他们实现的基础上tricky的hack，并且对于我们的需求来说，他们都太重了。于是我试图去找更轻量化的，不需要hack的库。然后我去研究其中一个项目的源码，发现我们所需要的功能，他的代码中写的十分简单，完全看不出来通过这些代码就可以实现功能的样子。再进一步研究惊喜的发现，他也是引入了别人的库来实现在线编辑功能。于是我顺藤摸瓜最后摸到了我们需要的库：亚马逊的ace，在线代码编辑器， git上15K个star。最后，我们只引入了这一个基础库，通过它提供的配置选项优雅地实现了需求。第三个于此经历相似，也是顺藤摸瓜。这个经历给我的震撼还是蛮大的。以前找第三方库的时候完全没有头绪，现在就信心很大，并且有一套方法去找到我们的目标。还有一点很重要就是，要相信这些很普遍的需求，一定会有一个很好的库来实现的。</li>
<li>帮QA解决自动化测试脚本中的代码问题<br>这个印象很深，是因为QA跑测试的时候有个没通过，以为是个bug过来问我。我觉得不应该通不过，于是猜测可能是脚本写的有问题，就去看了她的代码，发现果然如此。场景是数据修改，修改后判断页面上显示已经修改后的文字。然而在写测试的时候，她是同步的去写的，修改后马上做断言。真正的流程是异步的，应该在修改请求成功后再做断言。后来我们再发请求之后强行sleep3秒之后再做判断，测试果然通过。然后我又发现了一个问题：在做异步测试的时候，每次都是这样sleep几秒再做断言。这样就会有问题：因为sleep几秒之后，请求也不一定返回。我同她讲，她的测试表现不稳定经常挂掉，一定有这个sleep的原因。于是带着这个思路，开始找异步测试的准确方法。<br>这个经历给我的心得是，要透过现象看本质，坚持自己的想法和思路。</li>
<li>做平台登陆<br>做本项目的登陆是个很难受的过程。首先，我们的paas平台是以iframe的形式嵌在客户已有的云平台中的。我们的登陆，首先需要验证用户是否通过已有云平台的身份认证。所以我们的登陆流程是：从云平台拿到用户的云平台token-&gt;验证该token-&gt;验证通过则生成paas平台自己的Iot token。用户拿到Iot token后，每次请求都带上token就可以了。在实现时，要从iframe里中的URL里拿到云平台token发送给后端校验，然后再把iot token保存在vuex中。每次刷新，就会重新走一遍登陆流程。做完后测试发现功能十分不稳定，登陆时而成功时而不成功。最后我们把自己写的代码排查了一遍发现并没有问题，然后猜测是云平台token验证机制有问题。与云平台供应商说明情况一起排查才发现，原来他们并没有实时把新的token传给我们，这样的话我们就可能拿着已过期的token去进行身份验证，结果当然是挂的。得知这个事实的我们是无语的，万万想不到我们是因为这个原因导致登陆不稳定。本来按照正常流程，我把token存在vuex里是没有问题的。但是在我拿到的云平台token可能可能过期的情况下，为了保证开发和测试稳定登陆，我只能尽可能不去走云平台这套登陆流程，尽量用我们自己的iot token去认证身份。如此便出了一个下策：一旦拿到iot token，就将其存放在localStorage中，只有在iot token失效或者用户手动清除localStorage时才重新拿云平台token走登陆流程。这种做法安全性降低了很多，但是在依赖不稳定的情况下，并没有更优雅的办法了。</li>
</ol>
<p>收获：</p>
<ol>
<li>前端的全局观</li>
<li>解决问题的思路</li>
<li>找库的思路</li>
<li>对api的理解</li>
<li>vue从熟悉到熟练</li>
<li>iot的粗逻辑</li>
</ol>
<p>不足：</p>
<ol>
<li>没有及时做总结</li>
<li>对后端的依然知之甚少</li>
<li>对权威没敢质疑</li>
<li>没有考虑前端性能</li>
</ol>
<p>最后尤其想说的是我们的团队氛围真的很棒，连客户都称赞的2333。团队很小共8人，中途没有人员流动。首席和BA非常贴心，承包了很多脏活累活。senior的同事们也都乐于授教，总是不存在解决不了的问题。虽然听说一般local项目工期紧任务重加班多，但是我们几乎不需要加班，除了第一个迭代需要许多基础性的工作导致时间不够，或者迭代最后两天忙一些加一点班，总体来说节奏是很正常的。甚至还能每周一聚餐，不定期周末出游。希望以后经历的每个团队都能有这样的氛围和节奏呀～</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/总结/" rel="tag"># 总结</a>
          
            <a href="/tags/项目总结/" rel="tag"># 项目总结</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/03/30/201803月记/" rel="next" title="201803月记">
                <i class="fa fa-chevron-left"></i> 201803月记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/04/04/详解vue-从熟悉到熟练-part1-一个单文件组件的结构/" rel="prev" title="详解vue-从熟悉到熟练-part1-一个单文件组件的结构">
                详解vue-从熟悉到熟练-part1-一个单文件组件的结构 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="https://o3sw4xojp.qnssl.com/avatar.jpg"
               alt="LOLISuri" />
          <p class="site-author-name" itemprop="name">LOLISuri</p>
          <p class="site-description motion-element" itemprop="description">进击的程序媛</p>
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">29</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">18</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">LOLISuri</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  

  

  

  

  


</body>
</html>
